{"expireTime":9007200812251859000,"key":"transformer-remark-markdown-ast-de1dfd4b67180c3ed3edd26c3577388f-gatsby-remark-code-titlesgatsby-remark-embed-youtubegatsby-remark-imagesgatsby-remark-responsive-iframegatsby-remark-custom-blocksgatsby-remark-prismjsgatsby-remark-copy-linked-filesgatsby-remark-smartypants-","val":{"type":"root","children":[{"type":"heading","depth":2,"children":[{"type":"text","value":"riemann-dash:","position":{"start":{"line":2,"column":3,"offset":3},"end":{"line":2,"column":16,"offset":16},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":16,"offset":16},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"riemann-dash 是一个基于 ruby sinatra 的web展示界面，通过它可以把 riemann 收集到的数据通过不同的形式展示出来。一般来说，真正企业生产\n环境的监控系统是不会使用riemann-dash来作数据展示的，因为功能太简单，一些需求满足不了，大多会用 graphite 或者 grafana 来做替换。而我监控的目标\n是跑在几台虚拟机上的小爬虫，机器少，需求也简单，所以就没有用其他的工具来替换.\nriemann-dash的缺点中我比较不能接受的就是它默认没有用户认证来保护，这不安全。解决这个问题的办法比较常见的是在rack或者前端的nginx上做\nhttp basic auth，但是这样还是不如在应用内部做认证来的痛快，所以我修改了riemann-dash的代码添加了用户登录的功能","position":{"start":{"line":4,"column":1,"offset":18},"end":{"line":8,"column":69,"offset":376},"indent":[1,1,1,1]}}],"position":{"start":{"line":4,"column":1,"offset":18},"end":{"line":8,"column":69,"offset":376},"indent":[1,1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"修改代码:","position":{"start":{"line":10,"column":3,"offset":380},"end":{"line":10,"column":8,"offset":385},"indent":[]}}],"position":{"start":{"line":10,"column":1,"offset":378},"end":{"line":10,"column":8,"offset":385},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"riemann-dash是一个sinatra app, 代码非常简单，要满足我的需求在views目录里需要添加一个login.erubis，css直接写到页面里面了，然后修改controller目录\n里面的index.rb文件把登录注销的后端逻辑加入进去。完整代码在 ","position":{"start":{"line":12,"column":1,"offset":387},"end":{"line":13,"column":35,"offset":521},"indent":[1]}},{"type":"html","value":"<a class=\"reference external\" href=\"https://github.com/nuty/riemann-dash.git\">","position":{"start":{"line":13,"column":35,"offset":521},"end":{"line":13,"column":113,"offset":599},"indent":[]}},{"type":"text","value":"这里","position":{"start":{"line":13,"column":113,"offset":599},"end":{"line":13,"column":115,"offset":601},"indent":[]}},{"type":"html","value":"</a>","position":{"start":{"line":13,"column":115,"offset":601},"end":{"line":13,"column":119,"offset":605},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":13,"column":119,"offset":605},"end":{"line":13,"column":120,"offset":606},"indent":[]}}],"position":{"start":{"line":12,"column":1,"offset":387},"end":{"line":13,"column":120,"offset":606},"indent":[1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"安装启动:","position":{"start":{"line":15,"column":3,"offset":610},"end":{"line":15,"column":8,"offset":615},"indent":[]}}],"position":{"start":{"line":15,"column":1,"offset":608},"end":{"line":15,"column":8,"offset":615},"indent":[]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"因为没有合并到master也没有推到gems上面，所以只能用源码来安装了","position":{"start":{"line":17,"column":5,"offset":621},"end":{"line":17,"column":41,"offset":657},"indent":[]}}],"position":{"start":{"line":17,"column":1,"offset":617},"end":{"line":17,"column":41,"offset":657},"indent":[]}},{"type":"html","lang":"shell","value":"<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">git</span> clone https://github.com/nuty/riemann-dash.git\n<span class=\"token function\">cd</span> riemann-dash</code></pre></div>","position":{"start":{"line":19,"column":1,"offset":659},"end":{"line":22,"column":4,"offset":738},"indent":[1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"clone 完成后使用example下面的配置文件启动:","position":{"start":{"line":25,"column":5,"offset":745},"end":{"line":25,"column":33,"offset":773},"indent":[]}}],"position":{"start":{"line":25,"column":1,"offset":741},"end":{"line":25,"column":33,"offset":773},"indent":[]}},{"type":"html","lang":"shell","value":"<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">./bin/riemann-dash\n./example/config.rb</code></pre></div>","position":{"start":{"line":27,"column":1,"offset":775},"end":{"line":31,"column":4,"offset":827},"indent":[1,1,1,1]}},{"type":"heading","depth":3,"children":[{"type":"text","value":"如果打开配置文件，可以看到添加了两个配置项：","position":{"start":{"line":33,"column":5,"offset":833},"end":{"line":33,"column":27,"offset":855},"indent":[]}}],"position":{"start":{"line":33,"column":1,"offset":829},"end":{"line":33,"column":27,"offset":855},"indent":[]}},{"type":"html","lang":"shell","value":"<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">config.store<span class=\"token punctuation\">[</span>:username<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> username\nconfig.store<span class=\"token punctuation\">[</span>:password<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> password</code></pre></div>","position":{"start":{"line":35,"column":1,"offset":857},"end":{"line":38,"column":4,"offset":939},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"启动之后打开浏览器访问： ","position":{"start":{"line":40,"column":1,"offset":941},"end":{"line":40,"column":14,"offset":954},"indent":[]}},{"type":"html","value":"<a class=\"reference external\" href=\"http://0.0.0.0:4567/\">","position":{"start":{"line":40,"column":14,"offset":954},"end":{"line":40,"column":72,"offset":1012},"indent":[]}},{"type":"text","value":"http://0.0.0.0:4567/","position":{"start":{"line":40,"column":72,"offset":1012},"end":{"line":40,"column":92,"offset":1032},"indent":[]}},{"type":"html","value":"</a>","position":{"start":{"line":40,"column":92,"offset":1032},"end":{"line":40,"column":96,"offset":1036},"indent":[]}},{"type":"text","value":" \n输入在配置文件中设置的用户名和密码即可登录","position":{"start":{"line":40,"column":96,"offset":1036},"end":{"line":41,"column":22,"offset":1059},"indent":[1]}}],"position":{"start":{"line":40,"column":1,"offset":941},"end":{"line":41,"column":22,"offset":1059},"indent":[1]}},{"type":"paragraph","children":[{"type":"image","title":null,"url":"/riemann-dash-opt-32a3c0443a10d4aaf9d9e412f3d906cb.gif","alt":"gif","position":{"start":{"line":43,"column":1,"offset":1061},"end":{"line":43,"column":31,"offset":1091},"indent":[]}}],"position":{"start":{"line":43,"column":1,"offset":1061},"end":{"line":43,"column":31,"offset":1091},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":43,"column":31,"offset":1091}}}}